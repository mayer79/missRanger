<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multiple Imputation • missRanger</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Multiple Imputation">
<meta property="og:description" content="missRanger">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">missRanger</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/missRanger.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/multiple_imputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="../articles/working_with_censoring.html">Censored Variables</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mayer79/missRanger/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Multiple Imputation</h1>
            
            <h4 data-toc-skip class="date">2023-10-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mayer79/missRanger/blob/HEAD/vignettes/multiple_imputation.Rmd" class="external-link"><code>vignettes/multiple_imputation.Rmd</code></a></small>
      <div class="hidden name"><code>multiple_imputation.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="how-to-use-missranger-for-multiple-imputation">How to use {missRanger} for multiple imputation?<a class="anchor" aria-label="anchor" href="#how-to-use-missranger-for-multiple-imputation"></a>
</h2>
<p>For machine learning tasks, imputation is typically seen as a fixed
data preparation step like dummy coding. There, multiple imputation is
rarely applied as it adds another level of complexity to the analysis.
This might be fine since a good validation schema will account for
variation introduced by imputation.</p>
<p>For tasks with focus on statistical inference (p values, standard
errors, confidence intervals, estimation of effects), the extra
variability introduced by imputation has to be accounted for except if
only very few missing values appear. One of the standard approaches is
to impute the data set multiple times, generating e.g. 10 or 100
versions of a complete data set. Then, the intended analysis (t-test,
linear model etc.) is applied independently to each of the complete data
sets. Their results are combined afterward in a pooling step, usually by
Rubin’s rule <span class="citation">(<a href="#ref-rubin" role="doc-biblioref">Rubin 1987</a>)</span>. For parameter estimates,
averages are taken. Their variance is basically a combination of the
average squared standard errors plus the variance of the parameter
estimates across the imputed data sets, leading to inflated standard
errors and thus larger p values and wider confidence intervals.</p>
<p>The package {mice} <span class="citation">(<a href="#ref-buuren" role="doc-biblioref">Buuren and Groothuis-Oudshoorn 2011</a>)</span>
takes care of this pooling step. The creation of multiple complete data
sets can be done by {mice} or also by {missRanger}. In the latter case,
in order to keep the variance of imputed values at a realistic level, we
suggest to use predictive mean matching on top of the random forest
imputation.</p>
<p>The following example shows how easy such workflow looks like.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mayer79/missRanger" class="external-link">missRanger</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/amices/mice" class="external-link">mice</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">19</span><span class="op">)</span></span>
<span></span>
<span><span class="va">irisWithNA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generateNA.html">generateNA</a></span><span class="op">(</span><span class="va">iris</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate 20 complete data sets</span></span>
<span><span class="va">filled</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span></span>
<span>  <span class="fl">20</span>, </span>
<span>  <span class="fu"><a href="../reference/missRanger.html">missRanger</a></span><span class="op">(</span><span class="va">irisWithNA</span>, verbose <span class="op">=</span> <span class="fl">0</span>, num.trees <span class="op">=</span> <span class="fl">50</span>, pmm.k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, </span>
<span>  simplify <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span>                           </span>
<span><span class="co"># Run a linear model for each of the completed data sets                          </span></span>
<span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">filled</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Pool the results by mice</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pooled_fit</span> <span class="op">&lt;-</span> <span class="fu">pool</span><span class="op">(</span><span class="va">models</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#                term   estimate std.error  statistic       df      p.value</span></span>
<span><span class="co"># 1       (Intercept)  2.5366092 0.3575478  7.0944612 74.48225 6.365362e-10</span></span>
<span><span class="co"># 2       Sepal.Width  0.4262516 0.1104055  3.8607804 81.52526 2.253823e-04</span></span>
<span><span class="co"># 3      Petal.Length  0.7311306 0.0895942  8.1604670 60.04758 2.595957e-11</span></span>
<span><span class="co"># 4       Petal.Width -0.1840820 0.1856190 -0.9917193 68.08826 3.248458e-01</span></span>
<span><span class="co"># 5 Speciesversicolor -0.6755016 0.2907406 -2.3233824 82.80105 2.261132e-02</span></span>
<span><span class="co"># 6  Speciesvirginica -0.8584752 0.3970706 -2.1620217 81.93105 3.353349e-02</span></span>
<span></span>
<span><span class="co"># Compare with model on original data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Coefficients:</span></span>
<span><span class="co">#                   Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co"># (Intercept)        2.17127    0.27979   7.760 1.43e-12 ***</span></span>
<span><span class="co"># Sepal.Width        0.49589    0.08607   5.761 4.87e-08 ***</span></span>
<span><span class="co"># Petal.Length       0.82924    0.06853  12.101  &lt; 2e-16 ***</span></span>
<span><span class="co"># Petal.Width       -0.31516    0.15120  -2.084  0.03889 *  </span></span>
<span><span class="co"># Speciesversicolor -0.72356    0.24017  -3.013  0.00306 ** </span></span>
<span><span class="co"># Speciesvirginica  -1.02350    0.33373  -3.067  0.00258 ** </span></span>
<span><span class="co"># ---</span></span>
<span><span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Residual standard error: 0.3068 on 144 degrees of freedom</span></span>
<span><span class="co"># Multiple R-squared:  0.8673,  Adjusted R-squared:  0.8627 </span></span>
<span><span class="co"># F-statistic: 188.3 on 5 and 144 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>The standard errors and p values of the multiple imputation are
larger than of the original data set. This reflects the additional
uncertainty introduced by the presence of missing values in a realistic
way.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-buuren" class="csl-entry">
Buuren, Stef van, and Karin Groothuis-Oudshoorn. 2011. <span>“Mice:
Multivariate Imputation by Chained Equations in r.”</span> <em>Journal
of Statistical Software, Articles</em> 45 (3): 1–67. <a href="https://doi.org/10.18637/jss.v045.i03" class="external-link">https://doi.org/10.18637/jss.v045.i03</a>.
</div>
<div id="ref-rubin" class="csl-entry">
Rubin, D. B. 1987. <em>Multiple Imputation for Nonresponse in
Surveys</em>. Wiley Series in Probability and Statistics. Wiley.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Michael Mayer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
